# 数据和C

在第一章中，我们知道了程序是指令的集合，这些指令操作的实际上就是数据，本章我们将继续学习数据的知识，如果发现不熟悉的内容，我们会在后面的章节详细解释，下面我们开始数据的学习。

## 程序与数据

### 什么是“位”（bit）

计算机中最小的信息单位叫做：

> 位（bit，binary digit 的缩写）

一个 bit 只能表示：

- 0
- 或 1

显然，我们无法只用 1 个 bit 表示一个数字 100，或者一个汉字。

因此，我们需要把多个 bit 组合起来使用。

### 什么是“字节”（byte）

为了方便使用，计算机把 **8 个 bit 组合在一起**，形成一个更实用的单位：

> 字节（byte）

1 byte = 8 bit

例如：

```
01000001
```

这是一个字节。

8 个 bit 可以表示多少种状态？

每一位都有两种可能（0 或 1），因此：

2 × 2 × 2 × 2 × 2 × 2 × 2 × 2

 = 2⁸

 = 256 种不同状态

这意味着：

> 一个字节可以表示 256 个不同的数值

范围是：

0 ~ 255

### 内存：数据的存放空间

前面我们说过，变量本质是内存中的一块空间。

那么内存是什么？

可以把内存想象成：

> 一排排连续编号的小格子

每一个小格子存放：

- 1 个字节

而且每个字节都有自己的编号，这个编号叫做：

> 地址（address）

例如：

| 地址 | 存储内容 |
| ---- | -------- |
| 1000 | 1000001  |
| 1001 | 10       |
| 1002 | 11110000 |

### 整数如何存储？

假设我们存储数字 5。

十进制 5 转为二进制是：

```
00000101
```

如果使用 1 个字节存储，它就会以这种形式存入内存。

如果使用 4 个字节（int 常见大小）：

```
00000000 00000000 00000000 00000101
```

这 32 个 bit 共同表示整数 5。

## 变量：储存中的数据单元

在第一章的程序中，我们思考，若进行操作的数据只能是我们现输入进去的，那程序能做的事就很少很少了，我们若想对某些数据进行操作，那就需要将他们存起来，我们要存起来的数据可能是数字，一句话，或是另一个数据的位置，这就需要不同的数据类型，当然数据类型可不止这些大类，总体来说，我们存起来的这些数据，我们可以对他们进行一些操作，这些统称为变量。

### 什么是变量

可以将变量理解为带名字的内存空间。

例如：

```
int age = 18;
```

这行代码做了三件事：

1. 申请一块内存空间
2. 规定这块空间存储整数（int）
3. 把 18 存进去

一个变量包含三个要素：

1. 类型（type）
2. 名字（identifier）
3. 值（value）

#### 变量名

变量名也就是这个变量的名字上一个例子中age便是变量名，意义是年龄，当我们要对这里的18进行操作时，我们对计算机说age，他就能找到这段int类型的储存空间，对他进行操作。

#### 变量的命名规则

变量名（标识符）必须遵守规则：

1. 只能包含字母、数字、下划线
2. 不能以数字开头
3. 不能使用关键字

合法：

```C
score
user_age
total_count
```

非法：

```C
2score
int
```

##### 命名建议

良好的命名应该：

- 见名知意
- 避免拼音
- 避免无意义字母

不推荐：

```C
int a;
int b;
```

推荐：

```C
int student_age;
int total_score;
```

变量名是程序可读性的重要组成部分。

### 内存的声明与初始化

#### 初始化

声明变量：

```
int score;
```

此时：

- 申请了空间
- 但没有赋值

初始化变量：

```
int score = 90;
```

或者分开写：

```C
int score;
score = 90;
```

#### 未初始化变量的风险

看下面代码：

```C
int x;
printf("%d", x);
```

你可能会期待输出 0。

但实际结果可能是：

```C
32767
-842150451
```

原因是：

- 内存中的那块空间原本存放过别的东西
- 没有初始化时，值是随机的

规则：

> 使用变量前必须初始化。

这是良好编程习惯。

## 常量与标识符

### 常量

#### 什么是常量？

常量与变量的区别在于：

- **变量**：值可以改变
- **常量**：值在程序运行期间不能改变

常量是一种“固定”的值，它在定义时赋值之后，程序运行过程中无法被修改。

#### 常量的使用场景

常量通常用于那些程序运行过程中不会改变的值，例如数学常数 `PI`，程序中的配置参数，或者特定的数值，如最大值、最小值等。

例如：

```
const double PI = 3.14159;
```

此时，`PI` 是一个常量，它表示圆周率。无论程序如何运行，`PI` 的值都不会发生变化。

#### 常量的定义

**常量**可以通过两种方式来定义：

1. 使用 `const` 关键字
2. 使用宏定义（`#define`）

#### 使用 `const` 关键字

`const` 关键字用于声明常量，它可以让变量成为只读，并禁止修改其值。

```
const int MAX_AGE = 100;
```

在此例中，`MAX_AGE` 是一个常量，表示最大年龄为 100，程序中任何地方都无法修改它的值。

**常量的****作用域**：常量的作用域与变量类似，它的生命周期在其声明的作用域内。例如，局部常量仅在函数内有效，全局常量则在整个程序中有效。

#### 使用宏定义 `#define`

宏定义是一种预处理指令，用于定义常量或者常见表达式。与 `const` 不同，`#define` 并不定义变量，而是在预处理阶段将常量替换为实际的值。

```
#define PI 3.14159` `#define MAX_AGE 100
```

这种方法通常在没有类型限制的情况下使用，也适用于其他常量的定义。

但是，`#define` 并不做类型检查，也无法进行调试，因此推荐在可能的情况下使用 `const`。

#### 使用常量的好处

- **增加代码可读性**：常量用具名代替了魔法数字（magic number），例如使用 `PI` 代替 `3.14159`，让代码更加清晰。
- **防止意外修改**：使用常量后，程序员无法不小心修改它的值，增加了代码的稳定性。

### 标识符：给变量和常量命名

#### 什么是标识符？

在 C 语言中，**标识符**是程序中用于命名变量、常量、函数、数组、结构体等元素的名字。它们是由字母、数字和下划线组成的字符串，并且有一定的命名规则。

#### 标识符命名规则

C 语言对标识符的命名有一些规则和约定，我们需要遵守它们来保证代码的正确性和可读性。

##### 标识符的规则

1. **只能包含字母、数字和下划线（_）**，不能包含空格、特殊字符（如 `@`、`#`、`!` 等）。
2. **不能以数字开头**。例如，`1age` 是非法的，而 `age1` 是合法的。
3. **标识符不能是关键字**。C 语言中有一些保留的关键字（如 `int`、`if`、`while`、`return` 等），这些不能用作标识符。

## C语言基本数据类型

我们知道不同的数据需要不同类型的储存类型，即数据类型，接下来，我们首先来了解 C语言中与基本数据类型相关的关键字。

![img](https://gcn59lcrd80x.feishu.cn/space/api/box/stream/download/asynccode/?code=YTdmMjU0NTI1ZDRmOWFjMDUwNTQ5NzI0NDJkOTQ2ZjJfNkFKbGlvdzZEQ3Q4UXNJc2lmNGN1dGJSb1lXOTREUU9fVG9rZW46SzlZSmJnMUJMb2x1MjR4TU9kZmNDUnhubkRoXzE3NzEwODIyNTM6MTc3MTA4NTg1M19WNA)

### 整型和浮点型

上面的数据类型中，最好理解的便是整型和浮点型，他们用来储存数字，简单理解就是储存整数和小数。

#### int类型

对于最基本的int类型，它的大小一般是4个字节（由具体的编译系统决定），在储存单元的存储方式是整数的补码方式存放，比如5的二进制是101，则对应的二进制补码便是0000000000000101，即把空位用0补上，而整数也是有正负的，负数的存储方式是补码取反加一，下面2字节表示-5的过程：

**5 的原码**：

```Plain
00000000 00000101
```

**按位取反**：

```Plain
11111111 11111010
```

**再加 1**：

```Plain
11111111 11111011
```

得到 **-5 的****补码**：

```Plain
11111111 11111011
```

#### short int类型

短整型（short int）的关键字是short int或short，一般编译器分给其的大小为2个字节，一个短整型地 值的范围是-32768~32767。

#### long int类型

长整型（long int）的关键字是long int或者long，其大小一般也是4个字节，这事和int类型没有区别，对于有一些int类型只分给2个字节的大小的编译器来说long int类型是一个比较合适的类型。

#### long long类型

双长类型（long long int）的关键字是long long int或者longlong，其大小一般为8个字节，8字节能存储的数的大小就非常大了，有$-2^63~(2^63 - 1)$的范围

| 类型                                | 字节数 | 取值范围                                                     |
| ----------------------------------- | ------ | ------------------------------------------------------------ |
| int (基本整型)                      | 4      | -2 147 483 648～2 147 483 647，即 - 2³¹～(2³¹-1)             |
| unsigned int (无符号基本整型)       | 4      | 0～4 294 967 295，即 0～(2³²-1)                              |
| short (短整型)                      | 2      | -32 768～32 767，即 - 2¹⁵～(2¹⁵-1)                           |
| unsigned short (无符号短整型)       | 2      | 0～65 535，即 0～(2¹⁶-1)                                     |
| long (长整型)                       | 4      | -2 147 483 648～2 147 483 647，即 - 2³¹～(2³¹-1)             |
| unsigned long (无符号长整型)        | 4      | 0～4 294 967 295，即 0～(2³²-1)                              |
| long long (双长型)                  | 8      | -9 223 372 036 854 775 808～9 223 372 036 854 775 807，即 - 2⁶³～(2⁶³-1) |
| unsigned long long (无符号双长整型) | 8      | 0～18 446 744 073 709 551 615，即 0～(2⁶⁴-1)                 |

浮点型数据是用来表示小数的，你可能好奇为什么叫浮点型，听完解释后你应该会觉得很贴切。

小数是一个不确定位数的数字，但一个类型的存储空间是固定的，对于计算机来说并不能靠数字的大小判断一个数字占用的位数，小数的存储方式是由数字本身和位数存储的，例如一个小数3.14159可以表示为$0.314159*10^1$，或$314159*10^-6$，我们可以先将.314159存起来，再存入指数部分，像是先确定小数部分在移动小数点到正确的位置，因此被称为浮点型。

#### float型

单精度浮点型（float）的关键字是float ，编译系统会为其分配4个字节，能存的小数范围并不固定，和整数部分的位数也有关系，二进制形式表示一个实数以及存储单元的长度优先，不可能得到完全的精确值，只能存储有限的精确度，小数部分站的位越多，数的有效数字越多，指数部分站的位数越多，则能表示的数值范围越大。

float类型的数据能得到6位有效数字，数值范围为$-3.4*10^-38~3.4*10^-38$

#### double型

双精度浮点型（double）的关键字为double，此类型用8个字节存储一个double型数据，可以得到15位有效数字，数值范围为$-1.7*10^-308~1.7*10^-308$，为了提高运算的精度，C语言进行浮点数运算时，将float型的数据都自动转化为double型，在进行计算，计算结束后再根据情况输出。

| 类型        | 字节数 | 有效数字 | 数值范围 (绝对值)              |
| ----------- | ------ | -------- | ------------------------------ |
| float       | 4      | 6        | 0 以及 1.2×10⁻³⁸～3.4×10³⁸     |
| double      | 8      | 15       | 0 以及 2.3×10⁻³⁰⁸～1.7×10³⁰⁸   |
| long double | 8      | 15       | 0 以及 2.3×10⁻³⁰⁸～1.7×10³⁰⁸   |
| long double | 16     | 19       | 0 以及 3.4×10⁻⁴⁹³²～1.1×10⁴⁹³² |

注：long double型会随编译器的不同有区别

## 表达式与运算规则

在上一节中，我们学习了变量、常量和数据类型。现在，我们需要了解如何对数据进行操作。**表达式** 是由 **运算符** 和 **操作数** 组成的，它定义了数据如何进行计算。C 语言提供了丰富的运算符，可以用来处理不同类型的数据。理解这些运算符和它们的规则是学习 C 语言的核心之一。

### 算术运算符 —— 数字运算

**算术运算符** 用来对数值进行各种数学运算。它们是 C 语言中最常用的一类运算符。

#### 基本算术运算符

| 运算符 | 说明       | 示例  |
| ------ | ---------- | ----- |
| +      | 加法       | a + b |
| -      | 减法       | a - b |
| *      | 乘法       | a * b |
| /      | 除法       | a / b |
| %      | 取余（模） | a % b |

#### 使用算术运算符

我们来看一些实际示例，展示如何使用这些算术运算符。

```C
#include <stdio.h>

int main()
{
    int a = 10, b = 3;
    // 加法
    printf("a + b = %d\n", a + b);   // 输出：13
    
    // 减法
    printf("a - b = %d\n", a - b);   // 输出：7
    
    // 乘法
    printf("a * b = %d\n", a * b);   // 输出：30
    
    // 除法
    printf("a / b = %d\n", a / b);   // 输出：3（整数除法，结果是整数）
    
    // 取余
    printf("a %% b = %d\n", a % b);  // 输出：1（余数）
    
    return 0;
}
```

#### 整数除法与浮点除法

**整数除法** 会丢弃小数部分，只保留整数。例如：

```C
int a = 5, b = 2;
printf("%d", a / b);   // 输出 2
```

因为 `a / b = 2.5`，但结果会被舍去小数部分，输出为 `2`。

如果我们希望得到浮点数结果，可以将操作数转换为 `float` 或 `double`：

```C
float result = (float)a / b;  // 结果是 2.5
printf("%f", result);
```

### 赋值运算符 —— 赋值与更新

**赋值运算符** 是用来将右边的值赋给左边变量的运算符。最常用的是单一的 `=` 运算符。

#### 赋值运算符

| 运算符 | 说明     | 示例   |
| ------ | -------- | ------ |
| =      | 赋值     | a = b  |
| +=     | 加法赋值 | a += b |
| -=     | 减法赋值 | a -= b |
| *=     | 乘法赋值 | a *= b |
| /=     | 除法赋值 | a /= b |
| %=     | 取余赋值 | a %= b |

#### 赋值运算符的使用

我们来看一个简单的例子，演示如何使用赋值运算符：

```C
#include <stdio.h>

int main()
{int a = 10, b = 3;
    // 普通赋值
    a = b;printf("a = %d\n", a);  // 输出：3
    
    // 加法赋值
    a += b;  // 相当于 a = a + b
    printf("a += b: a = %d\n", a);  // 输出：6
    
    // 减法赋值
    a -= b;  // 相当于 a = a - b
    printf("a -= b: a = %d\n", a);  // 输出：3
    
    // 乘法赋值
    a *= b;  // 相当于 a = a * b
    printf("a *= b: a = %d\n", a);  // 输出：9
    
    // 除法赋值
    a /= b;  // 相当于 a = a / b
    printf("a /= b: a = %d\n", a);  // 输出：3
    
    // 取余赋值
    a %= b;  // 相当于 a = a % b
    printf("a %%= b: a = %d\n", a);  // 输出：0
    
    return 0;
}
```

注意：

- 运算符 `+=`, `-=`, `*=`, `/=`, 和 `%=` 是 **简化写法**，它们本质上等同于 `a = a + b`、`a = a - b` 等，只是更加简洁。

### 自增与自减运算符 —— 增减操作

**自增（++）与自减（--）** 运算符是最常见的运算符之一，用来对变量进行递增或递减操作。它们有两种形式：**前置**和**后置**。

#### 自增运算符（`++`）

| 形式 | 说明                   | 示例 |
| ---- | ---------------------- | ---- |
| ++a  | 前置自增，先增加再使用 | ++a  |
| a++  | 后置自增，先使用再增加 | a++  |

#### 自减运算符（`--`）

| 形式 | 说明                   | 示例 |
| ---- | ---------------------- | ---- |
| --a  | 前置自减，先减少再使用 | --a  |
| a--  | 后置自减，先使用再减少 | a--  |

#### 使用自增与自减运算符

```C
#include <stdio.h>

int main()
{int a = 5;
    // 后置自增
    printf("a++: %d\n", a++);  // 输出：5，a 变为 6
    printf("a: %d\n", a);      // 输出：6
    
    // 前置自增
    printf("++a: %d\n", ++a);  // 输出：7，a 变为 7
    
    // 后置自减
    printf("a--: %d\n", a--);  // 输出：7，a 变为 6
    printf("a: %d\n", a);      // 输出：6
    
    // 前置自减
    printf("--a: %d\n", --a);  // 输出：5，a 变为 5
    
    return 0;
}
```

#### 前置与后置自增自减的区别

- **后置自增**：先返回变量的原值，然后再加 1。
- **前置自增**：先加 1，然后再返回新值。

```C
int a = 5;
printf("a++: %d\n", a++);   // 输出 5, 然后 a = 6
printf("++a: %d\n", ++a);   // 输出 7, 因为 a = 6 之后加 1
```

### 类型转换 —— 数据类型之间的转换

在 C 语言中，不同类型的变量之间是可以进行 **类型转换** 的。类型转换分为 **隐式类型转换** 和 **显式类型转换**。

#### 隐式类型转换（自动转换）

隐式类型转换是 C 编译器自动进行的转换，通常是将 **较小范围的类型** 转换为 **较大范围的类型**，例如：`int` 转为 `float`，`float` 转为 `double` 等。

示例：

```C
int a = 5;
double b = 3.14;
double result = a + b;  // int 隐式转换为 double
printf("%f\n", result);  // 输出：8.140000
```

在此示例中，`a` 被隐式转换成了 `double` 类型，然后与 `b` 相加，最终结果是 `double` 类型。

#### 显式类型转换（强制转换）

**显式类型转换**是通过强制类型转换运算符 `(type)` 手动将一个类型转换为另一个类型。这通常用于将 **大范围的类型** 转换为 **小范围的类型**，或者进行不同类型之间的转换。

```C
double x = 5.75;
int y = (int)x;   // 强制转换，丢失小数部分
printf("y = %d\n", y);  // 输出：5
```

在这个例子中，`(int)` 强制将 `double` 类型的变量 `x` 转换为 `int`，结果小数部分 `.75` 被舍弃，只保留了整数部分 `5`。

#### 隐式与显式类型转换的区别

- **隐式转换**：由编译器自动进行，通常发生在较小类型转换为较大类型时。
- **显式转换**：由程序员通过 `(type)` 强制转换进行，通常用于将较大类型转换为较小类型，或者进行不相关类型之间的转换。

## 综合实例：编写一个完整的计算程序

### 练习一：计算圆的面积

#### 题目

编写一个程序，从键盘输入圆的半径（double 类型），计算并输出圆的面积。

圆面积公式：

面积=π×r2面积 = π × r^2面积=π×r2

要求：

- 使用 const 定义 π
- 输出结果保留两位小数

#### 解题思路

1. 定义一个 double 类型变量 r 用来存半径
2. 定义常量 PI
3. 根据公式计算面积
4. 使用 printf 输出结果

#### 完整代码

```C
#include <stdio.h>

int main()
{
    double r;
    const double PI = 3.14159;
    printf("请输入圆的半径：");
    scanf("%lf", &r);
    double area = PI * r * r;
    printf("圆的面积为：%.2f\n", area);
    return 0;
}
```

#### 代码解析

##### 变量定义

```
double r;
```

r 用于存储半径。

##### 常量定义

```
const double PI = 3.14159;
```

使用 const 防止误修改。

##### 输入

```
scanf("%lf", &r);
```

⚠ double 使用 `%lf` ⚠ 必须加 `&`

##### 面积计算

```
double area = PI * r * r;
```

r * r 表示平方。

##### 输出格式控制

```
%.2f
```

表示保留两位小数。

##### 易错点

- 忘记 &
- 把 `%lf` 写成 `%f`
- 写成 `PI * r ^ 2`（^ 不是平方）

### 练习二：摄氏度转华氏度

#### 题目

编写程序，从键盘输入摄氏温度（double 类型），转换为华氏温度并输出。

转换公式：

F=C×9/5+32F = C × 9/5 + 32F=C×9/5+32

#### 解题思路

1. 输入摄氏温度 C
2. 按公式计算 F
3. 输出结果

#### 完整代码

```C
#include <stdio.h>

int main()
{
    double c, f;
    printf("请输入摄氏温度：");
    scanf("%lf", &c);
    f = c * 9.0 / 5.0 + 32;
    printf("对应的华氏温度为：%.2f\n", f);
    return 0;
}
```

#### 代码解析

##### 为什么写 9.0 和 5.0？

如果写：

```
c * 9 / 5
```

9 和 5 是整数。

整数除法：

```
9 / 5 = 1
```

结果会错误。

写成：

```
9.0 / 5.0
```

会进行浮点运算。

#### 易错点

- 使用整数除法
- 忘记 &

### 练习三：交换两个变量的值

#### 题目

从键盘输入两个整数，交换它们的值，并输出交换后的结果。

例如：

输入：

```
3 5
```

输出：

```
5 3
```

#### 解题思路

交换变量需要借助“中间变量”。

步骤：

1. 定义 temp
2. temp = a
3. a = b
4. b = temp

#### 完整代码

```C
#include <stdio.h>

int main()
{
    int a, b, temp;
    printf("请输入两个整数：");
    scanf("%d %d", &a, &b);
    temp = a;
    a = b;
    b = temp;
    printf("交换后的结果为：%d %d\n", a, b);
    return 0;
}
```

#### 代码解析

假设输入：

```C
a = 3
b = 5
```

执行过程：

```C
temp = 3
a = 5
b = 3
```

交换完成。

#### 易错点

错误写法：

```C
a = b;
b = a;
```

这样会导致两个变量相同。

因为：

- a 已经被改成 b
- 再赋值时丢失原始值

### 练习四：计算三个数的平均值

#### 题目

从键盘输入三个整数，计算并输出它们的平均值。

要求：

- 平均值用 double 类型
- 输出保留两位小数

#### 解题思路

1. 输入三个整数
2. 求和
3. 转换为 double 再除以 3

#### 完整代码

```C
#include <stdio.h>

int main()
{
    int a, b, c;
    double average;
    printf("请输入三个整数：");
    scanf("%d %d %d", &a, &b, &c);
    average = (a + b + c) / 3.0;
    printf("平均值为：%.2f\n", average);
    return 0;
}
```

#### 代码解析

关键点：

```
(a + b + c) / 3.0
```

如果写：

```
(a + b + c) / 3
```

会进行整数除法。

例如：

```C
4 + 5 + 6 = 15
15 / 3 = 5
```

看似正确，但如果：

```C
5 + 6 + 7 = 18
18 / 3 = 6
```

仍然正确。

但如果：

```C
2 + 3 + 4 = 9
9 / 3 = 3
```

也正确。

问题出现在不能整除时：

```C
1 + 2 + 2 = 5
5 / 3 = 1
```

结果错误。

写成 3.0 强制浮点除法。

#### 易错点

- 忘记写 3.0
- 忘记 &